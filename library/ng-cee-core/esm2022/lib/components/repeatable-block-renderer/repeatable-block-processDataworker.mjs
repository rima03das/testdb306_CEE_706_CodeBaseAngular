export const PROCESS_SCRIPT = (input) => {
    const modifyFieldValueInput = (obj, stepId, position) => {
        for (const key in obj) {
            if (obj.hasOwnProperty(key)) {
                if ((key === "field" || key == "unique_id" || key == "additional_parameters")) {
                    if (key !== "additional_parameters") {
                        obj[key] = `${stepId}$accordion$${obj[key]}$${position}`;
                    }
                    else {
                        for (const param of obj[key]) {
                            if (param.parameter_type === "TargetFields") {
                                param.value = `${stepId}$${param.value}$${position}`;
                            }
                        }
                    }
                }
                else if (typeof obj[key] === "object" && obj[key] !== null) {
                    modifyFieldValueInput(obj[key], stepId, position);
                }
            }
        }
        return obj;
    };
    if (input.worker) {
        let fields = input.sample;
        let stepId = input.stepId;
        let position = input.position;
        let fieldUnq = [];
        let fieldsArr = [];
        let finalResult = {};
        for (let i = 0; i <= fields.length - 1; i++) {
            let result = modifyFieldValueInput(fields[i], stepId, position);
            fieldUnq.push(result.unique_id);
            fieldsArr.push(result);
        }
        finalResult = {
            fields: fieldsArr,
            fieldUnq: fieldUnq
        };
        postMessage(finalResult);
    }
    else {
        return input;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwZWF0YWJsZS1ibG9jay1wcm9jZXNzRGF0YXdvcmtlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL0FuZ3VsYXItMTcvRVNGLUFuZ3VsYXItV0ZFLUxpYnJhcnkvcHJvamVjdHMvbmctY2VlLWNvcmUvc3JjL2xpYi9jb21wb25lbnRzL3JlcGVhdGFibGUtYmxvY2stcmVuZGVyZXIvcmVwZWF0YWJsZS1ibG9jay1wcm9jZXNzRGF0YXdvcmtlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsQ0FBQyxLQUFLLEVBQUUsRUFBRTtJQUNwQyxNQUFNLHFCQUFxQixHQUFHLENBQUMsR0FBUSxFQUFFLE1BQVcsRUFBRSxRQUFnQixFQUFFLEVBQUU7UUFDeEUsS0FBSyxNQUFNLEdBQUcsSUFBSSxHQUFHLEVBQUU7WUFDbkIsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUN6QixJQUFJLENBQUMsR0FBRyxLQUFLLE9BQU8sSUFBSSxHQUFHLElBQUksV0FBVyxJQUFLLEdBQUcsSUFBSSx1QkFBdUIsQ0FBQyxFQUFFO29CQUM1RSxJQUFHLEdBQUcsS0FBSyx1QkFBdUIsRUFBQzt3QkFDL0IsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsTUFBTSxjQUFjLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxRQUFRLEVBQUUsQ0FBQztxQkFDNUQ7eUJBQU07d0JBQ0gsS0FBSyxNQUFNLEtBQUssSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUU7NEJBQzFCLElBQUksS0FBSyxDQUFDLGNBQWMsS0FBSyxjQUFjLEVBQUU7Z0NBQ3pDLEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxNQUFNLElBQUksS0FBSyxDQUFDLEtBQUssSUFBSSxRQUFRLEVBQUUsQ0FBQTs2QkFDdkQ7eUJBQ0o7cUJBQ0o7aUJBQ0o7cUJBQU0sSUFBSSxPQUFPLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxRQUFRLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLElBQUksRUFBRTtvQkFDMUQscUJBQXFCLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztpQkFDckQ7YUFDSjtTQUNKO1FBQ0QsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDLENBQUM7SUFDRixJQUFJLEtBQUssQ0FBQyxNQUFNLEVBQUU7UUFDaEIsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztRQUMxQixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO1FBQzFCLElBQUksUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUM7UUFDOUIsSUFBSSxRQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ2xCLElBQUksU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUNuQixJQUFJLFdBQVcsR0FBRyxFQUFFLENBQUM7UUFDckIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3pDLElBQUksTUFBTSxHQUFHLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDaEUsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDaEMsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUN4QjtRQUNELFdBQVcsR0FBRztZQUNaLE1BQU0sRUFBRyxTQUFTO1lBQ2xCLFFBQVEsRUFBRyxRQUFRO1NBQ3BCLENBQUM7UUFDRixXQUFXLENBQUMsV0FBVyxDQUFDLENBQUM7S0FDMUI7U0FBTTtRQUNMLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7QUFDSCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZGVjbGFyZSBmdW5jdGlvbiBwb3N0TWVzc2FnZShtZXNzYWdlOiBhbnkpOiBhbnk7XHJcblxyXG5leHBvcnQgY29uc3QgUFJPQ0VTU19TQ1JJUFQgPSAoaW5wdXQpID0+IHtcclxuICAgIGNvbnN0IG1vZGlmeUZpZWxkVmFsdWVJbnB1dCA9IChvYmo6IGFueSwgc3RlcElkOiBhbnksIHBvc2l0aW9uOiBudW1iZXIpID0+IHtcclxuICAgICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICBpZiAoKGtleSA9PT0gXCJmaWVsZFwiIHx8IGtleSA9PSBcInVuaXF1ZV9pZFwiIHx8ICBrZXkgPT0gXCJhZGRpdGlvbmFsX3BhcmFtZXRlcnNcIikpIHtcclxuICAgICAgICAgICAgICAgICAgaWYoa2V5ICE9PSBcImFkZGl0aW9uYWxfcGFyYW1ldGVyc1wiKXtcclxuICAgICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gYCR7c3RlcElkfSRhY2NvcmRpb24kJHtvYmpba2V5XX0kJHtwb3NpdGlvbn1gO1xyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJhbSBvZiBvYmpba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbS5wYXJhbWV0ZXJfdHlwZSA9PT0gXCJUYXJnZXRGaWVsZHNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbS52YWx1ZSA9IGAke3N0ZXBJZH0kJHtwYXJhbS52YWx1ZX0kJHtwb3NpdGlvbn1gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqW2tleV0gPT09IFwib2JqZWN0XCIgJiYgb2JqW2tleV0gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgbW9kaWZ5RmllbGRWYWx1ZUlucHV0KG9ialtrZXldLCBzdGVwSWQsIHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG9iajtcclxuICAgIH07XHJcbiAgICBpZiAoaW5wdXQud29ya2VyKSB7XHJcbiAgICAgIGxldCBmaWVsZHMgPSBpbnB1dC5zYW1wbGU7XHJcbiAgICAgIGxldCBzdGVwSWQgPSBpbnB1dC5zdGVwSWQ7XHJcbiAgICAgIGxldCBwb3NpdGlvbiA9IGlucHV0LnBvc2l0aW9uO1xyXG4gICAgICBsZXQgZmllbGRVbnEgPSBbXTtcclxuICAgICAgbGV0IGZpZWxkc0FyciA9IFtdO1xyXG4gICAgICBsZXQgZmluYWxSZXN1bHQgPSB7fTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gZmllbGRzLmxlbmd0aC0xOyBpKyspIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gbW9kaWZ5RmllbGRWYWx1ZUlucHV0KGZpZWxkc1tpXSwgc3RlcElkLCBwb3NpdGlvbik7XHJcbiAgICAgICAgZmllbGRVbnEucHVzaChyZXN1bHQudW5pcXVlX2lkKTtcclxuICAgICAgICBmaWVsZHNBcnIucHVzaChyZXN1bHQpO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbmFsUmVzdWx0ID0ge1xyXG4gICAgICAgIGZpZWxkcyA6IGZpZWxkc0FycixcclxuICAgICAgICBmaWVsZFVucSA6IGZpZWxkVW5xXHJcbiAgICAgIH07XHJcbiAgICAgIHBvc3RNZXNzYWdlKGZpbmFsUmVzdWx0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBpbnB1dDtcclxuICAgIH1cclxuICB9OyJdfQ==