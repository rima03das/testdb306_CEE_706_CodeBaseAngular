{"version":3,"file":"ng-cee-api-integration.mjs","sources":["../../../../../../angular 17 library/esf-angular-wfe-library/projects/ng-cee-api-integration/src/lib/ng-cee-api-integration.service.ts","../../../../../../angular 17 library/esf-angular-wfe-library/projects/ng-cee-api-integration/src/lib/ng-cee-api-integration.module.ts","../../../../../../angular 17 library/esf-angular-wfe-library/projects/ng-cee-api-integration/src/public-api.ts","../../../../../../angular 17 library/esf-angular-wfe-library/projects/ng-cee-api-integration/src/ng-cee-api-integration.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { SharedEventsServiceService, EventResponseHandlerService } from '@ng/cee-core';\r\nimport { forkJoin, Observable, throwError } from 'rxjs';\r\nimport { saveAs } from 'file-saver';\r\nimport { jwtDecode } from 'jwt-decode';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgCeeApiIntegrationService {\r\n\r\n  private downloadType = '';\r\n  private MimeTypeMap = {\r\n    csv: 'text/csv',\r\n    excel: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n    pdf: 'application/pdf'\r\n  };\r\n\r\n  private subscription: any = {};\r\n\r\n  constructor(\r\n    private sharedEventsService: SharedEventsServiceService,\r\n    private eventResponseHandler: EventResponseHandlerService,\r\n    private http: HttpClient) { }\r\n\r\n  init() {\r\n    this.subscription['apiIntegrationEmitter'] = this.sharedEventsService.apiIntegrationEventHandlerEmitter.subscribe(apiConfigData => {\r\n      // console.log(apiConfigData);\r\n      const response = {\r\n        handler: apiConfigData.handler,\r\n        response: null,\r\n        event_success: true,\r\n        storageType: apiConfigData.storageType,\r\n        statusCode: 0\r\n      };\r\n      this.downloadType = apiConfigData.downloadType;\r\n      this.ceeApiService(apiConfigData).subscribe(res => {\r\n        // console.log('check if api config data has download Type and then check type');\r\n        if (this.downloadType) {\r\n          const blob = new Blob([res.body], { type: this.MimeTypeMap[this.downloadType] });\r\n          const fileName = `File_${Math.floor(Date.now() / 1000)}.${this.downloadType.toLowerCase()}`;\r\n          saveAs(blob, fileName); // save the file\r\n        }\r\n        this.emitDataToCee(response, this.downloadType ? { body: {}, status: 200 } : res, apiConfigData, true);\r\n      }, error => {\r\n        console.error(`Error Occurred for handler: ${apiConfigData.handler} and ${JSON.stringify(error)}`);\r\n        if (apiConfigData.hasAuthorisation && localStorage.getItem('CEE_OIDC') === '1' && error.status === 401) {\r\n          // check if the hasAuthorization is true for this event and CEE_OIDC 1 and status code is 401\r\n          // then emit the oidcDataEmitter to refresh the token and revalidate and again hit the api with all the data\r\n          const obj: RefreshAccessToken = {\r\n            oldApiConfigData: apiConfigData\r\n          };\r\n          this.sharedEventsService.apiUnauthorizedEmitter.emit(obj);\r\n        } else {\r\n          this.emitDataToCee(response, error, apiConfigData, false);\r\n        }\r\n      });\r\n\r\n    });\r\n\r\n    this.subscription['apiIntegrationParallelEmitter'] = this.sharedEventsService.apiIntegrationParallelEventHandlerEmitter.subscribe(apiConfigDataArr => {\r\n      // console.log('Parallel API Integration Handler: ', apiConfigDataArr);\r\n\r\n      // **************** Parallel API Response Handling ******************\r\n      var handlerArr = apiConfigDataArr.map(config => config.handler);\r\n      this.ceeParallelApiService(apiConfigDataArr).subscribe({\r\n        next: (handlerArr) => {\r\n          handlerArr.forEach((res, index) => {\r\n            let response = {\r\n              handler: apiConfigDataArr.map(config => config.handler)[index],\r\n              response: null,\r\n              event_success: true,\r\n              storageType: apiConfigDataArr[index].storageType,\r\n              statusCode: 0\r\n            };\r\n            apiConfigDataArr[index].isEvent = false; // default isEvent to false\r\n            this.emitDataToCee(response, handlerArr[index], apiConfigDataArr[index], true);\r\n            // console.log( response.handler, ' :handler response Data: ', handlerArr[index]);\r\n          });\r\n        },\r\n        error: (err) => {\r\n          console.error('Error in one of the requests:', err);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * function that emits back the api response for a particular api\r\n   * @param response the response object\r\n   * @param res the response\r\n   * @param isEvent if the handler is called from an event\r\n   * @param success if the api res is success\r\n   */\r\n  private emitDataToCee(response, res, apiConfigData, success) {\r\n    response.statusCode = res.status;\r\n    response.response = res.body || res.error;\r\n    response.event_success = success;\r\n    /* ESB API INTIGRATION */\r\n    if (apiConfigData.isESB && response.response.api_response) {\r\n      response.response = JSON.parse(response.response.api_response);\r\n    }\r\n    /* ESB API INTIGRATION (END) */\r\n    if (apiConfigData.isEvent) {\r\n      this.sharedEventsService.eventResponseSubscriber.emit(response);\r\n    } else {\r\n      this.eventResponseHandler.emitAPIDATA(response);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * CEE internal API Service that hits the api\r\n   * @param apiConfigData the api config data for the handler\r\n   * via internal libraries of CEE\r\n   */\r\n  private ceeApiService(apiConfigData): Observable<any> {\r\n    //\r\n    const headers = apiConfigData.headers;\r\n    // set header request type\r\n    switch (apiConfigData.requestType) {\r\n      case 'application/json':\r\n      case 'multipart/form-data':\r\n      case 'application/x-www-form-urlencoded':\r\n      case 'text/plain':\r\n        headers['Content-Type'] = apiConfigData.requestType;\r\n        break;\r\n      default:\r\n        console.error(`Invalid request type in returnHeaders: ${apiConfigData.requestType}`);\r\n    }\r\n\r\n    let apiURL = apiConfigData.url;\r\n\r\n    // set url param\r\n    for (const key of Object.keys(apiConfigData.urlParams)) {\r\n      if (apiURL.includes(`{${key}}`)) {\r\n        apiURL = apiURL.split(`{${key}}`).join(apiConfigData.urlParams[key]);\r\n      }\r\n    }\r\n\r\n    // set query param\r\n    // CI-1397 >> query params with [*]\r\n    const queryParamObj = {};\r\n    for (const key of Object.keys(apiConfigData.queryParams)) {\r\n      if (Array.isArray(apiConfigData.queryParams[key])) {\r\n        const keys = Object.keys(apiConfigData.queryParams[key][0]);\r\n        for (const q of keys) {\r\n          queryParamObj[key + '.' + q] = '[' + apiConfigData.queryParams[key].map(a => a[q]) + ']';\r\n        }\r\n      } else {\r\n        queryParamObj[key] = apiConfigData.queryParams[key];\r\n      }\r\n    }\r\n    for (const key of Object.keys(queryParamObj)) {\r\n      if (apiURL.includes(`{${key}}`)) {\r\n        apiURL = apiURL.split(`{${key}}`).join(queryParamObj[key]);\r\n      }\r\n    }\r\n    // set request body\r\n    let requestBody = this.formRequestBody(apiConfigData.requestBody, apiConfigData.requestType);\r\n    /* ESB API INTIGRATION */\r\n    if (apiConfigData.isESB) {\r\n      requestBody = {\r\n        api_request: JSON.stringify(requestBody)\r\n      };\r\n      if (apiConfigData.esbRequestBody) {\r\n        requestBody = Object.assign(requestBody, apiConfigData.esbRequestBody);\r\n      }\r\n    }\r\n    /* ESB API INTIGRATION (END) */\r\n\r\n    // check downloadType if valid download Type then add responseType as blob\r\n    switch (apiConfigData.methodType.toUpperCase()) {\r\n      case 'POST':\r\n      case 'PUT':\r\n      case 'PATCH':\r\n        return this.http[apiConfigData.methodType.toLowerCase()](\r\n          apiURL,\r\n          requestBody,\r\n          this.downloadType ? {\r\n            headers,\r\n            observe: 'response',\r\n            responseType: 'blob'\r\n          }\r\n            : { headers, observe: 'response' });\r\n        break;\r\n      case 'DELETE':\r\n        return this.http[apiConfigData.methodType.toLowerCase()](\r\n          apiURL,\r\n          this.downloadType ? {\r\n            headers,\r\n            observe: 'response',\r\n            responseType: 'blob',\r\n            body: requestBody\r\n          }\r\n            : { headers, observe: 'response', body: requestBody });\r\n        break;\r\n      case 'GET':\r\n        return this.http[apiConfigData.methodType.toLowerCase()](\r\n          apiURL,\r\n          this.downloadType ? {\r\n            headers,\r\n            observe: 'response',\r\n            responseType: 'blob'\r\n          }\r\n            : { headers, observe: 'response' });\r\n        break;\r\n    }\r\n  }\r\n\r\n  private getCookie(name: string) {\r\n    const ca: Array<string> = document.cookie.split(';');\r\n    const caLen: number = ca.length;\r\n    const cookieName = `${name}=`;\r\n    let c: string;\r\n\r\n    for (let i = 0; i < caLen; i += 1) {\r\n      c = ca[i].replace(/^\\s+/g, '');\r\n      if (c.indexOf(cookieName) === 0) {\r\n        return c.substring(cookieName.length, c.length);\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n\r\n  private ceeParallelApiService(apiConfigDataArr): Observable<any> {\r\n    // Create an array to hold all HTTP requests\r\n    var httpObjArr = [];\r\n    apiConfigDataArr.forEach(apiConfigData => {\r\n      // ################## Parallel Api Request Processing ####################\r\n      var headers = apiConfigData.headers;\r\n      // set header request type\r\n      switch (apiConfigData.requestType) {\r\n        case 'application/json':\r\n        case 'multipart/form-data':\r\n        case 'application/x-www-form-urlencoded':\r\n        case 'text/plain':\r\n          headers['Content-Type'] = apiConfigData.requestType;\r\n          break;\r\n        default:\r\n          console.error(`Invalid request type in returnHeaders: ${apiConfigData.requestType}`);\r\n      }\r\n\r\n      const accessToken = `${this.getCookie('headerPayload')}.${this.getCookie('signature')}`\r\n      const decoded: any = jwtDecode(accessToken);\r\n      headers.Authorization = `Bearer ${accessToken}`;\r\n\r\n      let apiURL = apiConfigData.url;\r\n\r\n      // set url param\r\n      for (const key of Object.keys(apiConfigData.urlParams)) {\r\n        if (apiURL.includes(`{${key}}`)) {\r\n          apiURL = apiURL.split(`{${key}}`).join(apiConfigData.urlParams[key]);\r\n        }\r\n      }\r\n\r\n      // set query param\r\n      const queryParamObj = {};\r\n      for (const key of Object.keys(apiConfigData.queryParams)) {\r\n        if (Array.isArray(apiConfigData.queryParams[key])) {\r\n          const keys = Object.keys(apiConfigData.queryParams[key][0]);\r\n          for (const q of keys) {\r\n            queryParamObj[key + '.' + q] = '[' + apiConfigData.queryParams[key].map(a => a[q]) + ']';\r\n          }\r\n        } else {\r\n          queryParamObj[key] = apiConfigData.queryParams[key];\r\n        }\r\n      }\r\n      for (const key of Object.keys(queryParamObj)) {\r\n        if (apiURL.includes(`{${key}}`)) {\r\n          apiURL = apiURL.split(`{${key}}`).join(queryParamObj[key]);\r\n        }\r\n      }\r\n      // set request body\r\n      let requestBody = this.formRequestBody(apiConfigData.requestBody, apiConfigData.requestType);\r\n      /* ESB API INTIGRATION */\r\n      if (apiConfigData.isESB) {\r\n        requestBody = {\r\n          api_request: JSON.stringify(requestBody)\r\n        };\r\n        if (apiConfigData.esbRequestBody) {\r\n          requestBody = Object.assign(requestBody, apiConfigData.esbRequestBody);\r\n        }\r\n      }\r\n      /* ESB API INTIGRATION (END) */\r\n\r\n      // check downloadType if valid download Type then add responseType as blob\r\n      switch (apiConfigData.methodType.toUpperCase()) {\r\n        case 'POST':\r\n        case 'PUT':\r\n        case 'PATCH':\r\n          httpObjArr.push(this.http[apiConfigData.methodType.toLowerCase()](\r\n            apiURL,\r\n            requestBody,\r\n            this.downloadType ? {\r\n              headers,\r\n              observe: 'response',\r\n              responseType: 'blob'\r\n            }\r\n              : { headers, observe: 'response' }));\r\n          break;\r\n        case 'DELETE':\r\n          httpObjArr.push(this.http[apiConfigData.methodType.toLowerCase()](\r\n            apiURL,\r\n            this.downloadType ? {\r\n              headers,\r\n              observe: 'response',\r\n              responseType: 'blob',\r\n              body: requestBody\r\n            }\r\n              : { headers, observe: 'response', body: requestBody }));\r\n          break;\r\n        case 'GET':\r\n          httpObjArr.push(this.http[apiConfigData.methodType.toLowerCase()](\r\n            apiURL,\r\n            this.downloadType ? {\r\n              headers,\r\n              observe: 'response',\r\n              responseType: 'blob'\r\n            }\r\n              : { headers, observe: 'response' }));\r\n          break;\r\n      }\r\n      // ######################################\r\n    });\r\n    // Parallel Api Calling using forkJoin\r\n    // forkJoin will wait for all the requests to complete and then return an array of responses\r\n    return forkJoin(httpObjArr);\r\n  }\r\n\r\n  private formRequestBody(requestData: any, type: string) {\r\n    switch (type) {\r\n      case 'text/plain':\r\n      case 'application/json':\r\n        return requestData;\r\n      case 'multipart/form-data':\r\n        const fd = new FormData();\r\n        for (const key of Object.keys(requestData)) {\r\n          fd.append(key, requestData[key]);\r\n        }\r\n        return fd;\r\n      case 'application/x-www-form-urlencoded':\r\n        const body = new URLSearchParams();\r\n        for (const key of Object.keys(requestData)) {\r\n          body.set(key, requestData[key]);\r\n        }\r\n        return body.toString();\r\n      default:\r\n        console.error(`Invalid request type in formRequestBody: ${type}`);\r\n        return {};\r\n    }\r\n  }\r\n\r\n  destroySubscription() {\r\n    // Called once, before the instance is destroyed.\r\n    // Add 'implements OnDestroy' to the class.\r\n    for (const singleSubscription in this.subscription) {\r\n      if (this.subscription[singleSubscription]) {\r\n        this.subscription[singleSubscription].unsubscribe();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport interface RefreshAccessToken {\r\n  oldApiConfigData: object;\r\n}\r\n","import { HttpClientModule } from '@angular/common/http';\r\nimport { NgModule } from '@angular/core';\r\n\r\n\r\n@NgModule({\r\n  declarations: [],\r\n  imports: [\r\n    HttpClientModule\r\n  ],\r\n  exports: []\r\n})\r\nexport class NgCeeApiIntegrationModule { }\r\n","/*\r\n * Public API Surface of ng-cee-api-integration\r\n */\r\n\r\nexport { NgCeeApiIntegrationService } from './lib/ng-cee-api-integration.service';\r\nexport { NgCeeApiIntegrationModule } from './lib/ng-cee-api-integration.module';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}